<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <h1>ZKG Counter Upload</h1>
  <p>Upload a Crucible screenshot — it will save to Drive and log this matchup into the Counter App.</p>

  <input type="file" id="fileInput" accept="image/*" />
  <button onclick="upload()">Upload Screenshot</button>

  <p id="status"></p>
  <img id="preview" style="max-width:90%;margin-top:10px;display:none;"/>

  <script>
  function upload() {
    const file = document.getElementById("fileInput").files[0];
    if (!file) return alert("Pick a file first!");
    const reader = new FileReader();
    reader.onload = function(e) {
      document.getElementById("status").innerText = "Uploading...";
      google.script.run
        .withSuccessHandler(res => {
          if (res.ok) {
            document.getElementById("status").innerText =
              "✅ Uploaded! Row " + res.row;
            const img = document.getElementById("preview");
            img.src = res.url;
            img.style.display = "block";
          } else {
            document.getElementById("status").innerText = "❌ " + res.error;
          }
        })
        .withFailureHandler(err => {
          document.getElementById("status").innerText = "❌ " + err.message;
        })
        .uploadImage(e.target.result);
    };
    reader.readAsDataURL(file);
  }
  </script>
</body>
</html>
